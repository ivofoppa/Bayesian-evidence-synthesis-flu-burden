###################################################################################################
###  This code is designed to investigate which of the multiple solutions to the       ############
###  lem" from Farrington et al. 1992                                                  ############
###  Ivo M. Foppa, October 2018                                                        ############
###################################################################################################
Npop <- 2e+6 ### Source population
vacc <- .5   ### Vaccination rate
AR <- .2     ### Seasonal attack rate
seas <- 150  ### Duration of season in days
lambda <- -log(AR)/seas ### Daily infection rate (per person per day)
rho <- 0.01  ### Rate of vaccination protection loss
R0 <- .3     ### Initial vaccine failure (proportion)
###################################################################################################
###################################################################################################
Nv0 <- Npop*vacc   ### Numbers vaccinated
Nu0 <- Npop - Nv0  ### Numbers unvaccinated
###################################################################################################
###################################################################################################
Sv0 <- Nv0*(1 - R0) ### Number vaccinated and susceptible
Su0 <- Nu0          ### Number unvaccinated and susceptible
###################################################################################################
###################################################################################################
Sv <- Sv0           ### Initialize vaccinated susceptibles
Su <- Su0           ### Initialize unvaccinated susceptibles
R <- R0             ### Imnitialize vaccine failures over time
###################################################################################################
###################################################################################################
###################################################################################################
R <- sapply(2:seas, function(d) R[d] <<- 1 - (1 - R[d-1])*exp(-rho));
Rprime <- diff(R)

surv_a <- function(a,u){
  Rprime[u]*exp(-lambda*(a - u))
}

a <- 40
ls <- sapply(seq_along(Rprime[1:a]),function(u) surv_a(a,u))
###################################################################################################
###################################################################################################















